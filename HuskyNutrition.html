<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Husky Nutrition</title>
    <link rel="stylesheet" href="HuskyNutrition.css">
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
</head>
<body>

    <!-- En-t√™te Cliquable -->
    <header onclick="showView('home-view')" style="cursor: pointer;">
        <h1>Husky Nutrition</h1>
    </header>

    <!-- 1. PAGE D'ACCUEIL -->
    <section id="home-view" class="view active">
        <div class="dashboard">
            <h2>R√©sum√© Journalier</h2>
            <div class="calories-circle">
                <div class="circle-content">
                    <span id="display-remaining-cal">0</span>
                    <small>Restant</small>
                </div>
                <svg viewBox="0 0 36 36" class="circular-chart">
                    <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                    <path id="circle-progress" class="circle" stroke-dasharray="0, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                </svg>
            </div>
            
            <!-- Nouveau bouton style Menu pour voir le d√©tail -->
            <button class="btn-action" style="width: auto; padding: 8px 20px; margin-bottom: 15px; background-color: #333; border: 1px solid #444;" onclick="showView('journal-view'); renderDailyLog();">
                üìú Voir le d√©tail / Modifier
            </button>

            <p class="total-target">Objectif : <span id="display-target-cal">0</span> kcal</p>

            <div class="macros-container">
                <div class="macro-box">
                    <span>Prot.</span>
                    <progress id="prog-prot" value="0" max="100"></progress>
                    <span class="macro-val"><span id="val-prot">0</span>/<span id="target-prot">0</span>g</span>
                </div>
                <div class="macro-box">
                    <span>Gluc.</span>
                    <progress id="prog-carb" value="0" max="100"></progress>
                    <span class="macro-val"><span id="val-carb">0</span>/<span id="target-carb">0</span>g</span>
                </div>
                <div class="macro-box">
                    <span>Lip.</span>
                    <progress id="prog-fat" value="0" max="100"></progress>
                    <span class="macro-val"><span id="val-fat">0</span>/<span id="target-fat">0</span>g</span>
                </div>
            </div>
        </div>


        <!-- Menu Principal (Ordre modifi√©) -->
        <div class="menu-grid">
            <button class="btn-menu" onclick="showView('tracker-view')">üçΩÔ∏è J'ai mang√©</button>
            <button class="btn-menu" onclick="showView('alcohol-view')">üç∑ Alcool</button> <!-- Invers√© -->
            <button class="btn-menu" onclick="showView('recipes-view'); renderRecipesList();">üë®‚Äçüç≥ Recettes</button>
            <button class="btn-menu" onclick="showView('foods-view'); renderAllFoods();">üçé Mes Aliments</button>
            <button class="btn-menu" onclick="showView('scanner-view')">üì∑ Scanner</button>
            <button class="btn-menu" onclick="showView('calc-view')">üßÆ Calculer Besoins</button> <!-- Invers√© -->
        </div>

        <div class="data-controls">
            <button class="btn-menu" style="font-size: 0.9rem; padding: 12px;" onclick="exportData()">
                ‚¨áÔ∏è Sauvegarder
            </button>
            <input type="file" id="file-import" style="display:none" onchange="importData(this)">
            <button class="btn-menu" style="font-size: 0.9rem; padding: 12px;" onclick="document.getElementById('file-import').click()">
                ‚¨ÜÔ∏è Charger
            </button>
        </div>

<!-- Logo cliquable vers index.html -->
        <div style="text-align: center; margin-top: 20px;">
            <img src="HUSKY-Fitness.png" 
                 alt="HUSKY Fitness" 
                 onclick="window.location.href='index.html'" 
                 style="cursor: pointer; max-width: 300px; width: 50%; height: auto; border-radius: 10px; box-shadow: 0 4px 15px rgba(33,150,243,0.3); transition: transform 0.2s;"
                 onmouseover="this.style.transform='scale(1.05)'"
                 onmouseout="this.style.transform='scale(1)'">
        </div>

    </section>

    <!-- 2. CALCULATEUR -->
    <section id="calc-view" class="view">
        <button class="btn-back" onclick="showView('home-view')">‚Üê Retour</button>
        <h2>Calcul des Besoins</h2>
        
        <div class="form-group">
            <label>Genre</label>
            <select id="calc-gender"><option value="m">Homme</option><option value="f">Femme</option></select>
        </div>
        <div class="form-group">
            <label>Poids (kg)</label>
            <input type="number" id="calc-weight" placeholder="Ex: 80">
        </div>
        <div class="form-group">
            <label>Taille (cm)</label>
            <input type="number" id="calc-height" placeholder="Ex: 180">
        </div>
        <div class="form-group">
            <label>Age (ans)</label>
            <input type="number" id="calc-age" placeholder="Ex: 30">
        </div>

        <h3>Activit√©</h3>
        <div class="form-group">
            <label>M√©tier</label>
            <select id="calc-job">
                <option value="1.2">S√©dentaire (Bureau)</option>
                <option value="1.4">Actif (Vendeur, Prof)</option>
                <option value="1.6">Mod√©r√© (Serveur, Facteur)</option>
                <option value="1.75">Intense (B√¢timent)</option>
                <option value="1.9">Tr√®s intense (D√©m√©nageur)</option>
            </select>
        </div>
        <div class="form-group">
            <label>Pas / Jour</label>
            <select id="calc-steps">
                <option value="0">< 5 000</option>
                <option value="0.05">5 000 - 7 500</option>
                <option value="0.1">7 500 - 9 999</option>
                <option value="0.15">10 000 - 12 499</option>
                <option value="0.2">‚â• 12 500</option>
            </select>
        </div>
        <div class="form-group">
            <label>Entrainements / Semaine</label>
            <select id="calc-workouts">
                <option value="0">0 - 1</option>
                <option value="0.05">2 - 3</option>
                <option value="0.1">4 - 5</option>
                <option value="0.15">6+</option>
            </select>
        </div>

        <h3>Objectif & Macros</h3>
        <div class="form-group">
            <label>Aide au choix</label>
            <div style="display:flex; gap:5px;">
                <select id="goal-type"><option value="cut">S√®che</option><option value="maint">Maintien</option><option value="bulk">Prise de masse</option></select>
                <select id="goal-muscle"><option value="low">Muscle Faible</option><option value="med">Muscle Moyen</option><option value="high">Muscle √âlev√©</option></select>
                <select id="goal-fat"><option value="low">Gras Faible</option><option value="med">Gras Moyen</option><option value="high">Gras √âlev√©</option></select>
            </div>
            <button class="btn-action" onclick="applyGoalTemplate()">Appliquer le profil</button>
        </div>

        <div class="form-group">
            <label>Ajustement Kcal (%)</label>
            <input type="number" id="calc-adjust-percent" value="0">
        </div>
        <div class="form-group">
            <label>Prot√©ines (g/kg)</label>
            <input type="number" id="calc-prot-g" step="0.1" value="1.8">
        </div>
        <div class="form-group">
            <label>Lipides (g/kg)</label>
            <input type="number" id="calc-fat-g" step="0.1" value="1.0">
        </div>

        <button class="btn-submit" onclick="saveCalculation()">Valider et Sauvegarder</button>
    </section>

    <!-- 3. TRACKER / MANGER -->
    <section id="tracker-view" class="view">
        <button class="btn-back" onclick="showView('home-view')">‚Üê Retour</button>
        <h2>Ajouter un aliment</h2>
        
        <input type="text" id="search-input" placeholder="Rechercher (Aliment, Recette)..." oninput="searchDatabase()">
        
        <div id="search-results" class="results-list"></div>

        <div id="selected-food-area" style="display:none; margin-top: 20px; border-top: 1px solid #333; padding-top:10px;">
            <h3 id="selected-food-name">Aliment</h3>
            <label id="lbl-qty">Quantit√© (g) :</label>
            <input type="number" id="food-qty" value="100">
            <button class="btn-submit" onclick="confirmEaten()">Confirmer</button>
        </div>
    </section>

    <!-- 4. RECETTES -->
    <section id="recipes-view" class="view">
        <button class="btn-back" onclick="showView('home-view')">‚Üê Retour</button>
        <h2>Mes Recettes</h2>
        <button class="btn-submit" onclick="openRecipeCreator()">+ Cr√©er une recette</button>
        <div id="saved-recipes-list" class="results-list" style="margin-top: 20px;"></div>
    </section>

    <!-- 5. CR√âATEUR RECETTE -->
    <section id="recipe-creator-view" class="view">
        <button class="btn-back" onclick="showView('recipes-view')">‚Üê Annuler</button>
        <h2>Nouvelle Recette</h2>
        <div class="form-group">
            <label>Nom de la recette</label>
            <input type="text" id="recipe-name" placeholder="Ex: Salade C√©sar poulet">
        </div>
        <div class="card-highlight">
            <h3>Ajouter Ingr√©dients</h3>
            <input type="text" id="recipe-ingredient-search" placeholder="Chercher ingr√©dient..." oninput="searchIngredientForRecipe()">
            <div id="recipe-search-results" class="results-list" style="max-height: 150px;"></div>
        </div>
        <h3>Ingr√©dients inclus :</h3>
        <div id="recipe-draft-list" class="draft-list"></div>
        <div class="macro-summary">
            <p>Total Recette : <span id="recipe-total-cal">0</span> kcal</p>
            <small>P: <span id="recipe-total-p">0</span>g | G: <span id="recipe-total-c">0</span>g | L: <span id="recipe-total-f">0</span>g</small>
        </div>
        <button class="btn-submit" onclick="saveRecipe()">Sauvegarder la recette</button>
    </section>

    <!-- 6. SCANNER -->
    <section id="scanner-view" class="view">
        <button class="btn-back" onclick="showView('home-view')">‚Üê Retour</button>
        <h2>Scanner Code-Barre</h2>
        <div id="reader" style="width: 100%"></div>
        <div class="form-group">
            <label>Ou saisir code manuellement :</label>
            <input type="text" id="manual-barcode">
            <button class="btn-action" onclick="fetchOpenFoodFacts(document.getElementById('manual-barcode').value)">Rechercher</button>
        </div>
    </section>

    <!-- 7. R√âSULTAT SCAN (NOUVELLE VUE) -->
    <section id="scan-result-view" class="view">
        <button class="btn-back" onclick="showView('scanner-view')">‚Üê Retour Scan</button>
        <h2>Produit Trouv√© !</h2>
        
        <div class="card-highlight" style="text-align:center; margin-top:20px;">
            <h3 id="scan-match-name" style="color:var(--primary-color); margin-bottom:10px;">Produit</h3>
            <div class="macro-summary">
                <small>Pour 100g :</small><br>
                <span id="scan-match-macros">P: 0g | G: 0g | L: 0g</span>
            </div>
        </div>

        <div class="form-group" style="margin-top:20px;">
            <button class="btn-submit" onclick="scanActionEat()">üçΩÔ∏è J'ai mang√© √ßa</button>
            <button class="btn-action" style="margin-top:10px; background: #4CAF50;" onclick="scanActionSave()">üíæ Ajouter aux aliments</button>
        </div>
    </section>

    <!-- 8. ALCOOL -->
    <section id="alcohol-view" class="view">
        <button class="btn-back" onclick="showView('home-view')">‚Üê Retour</button>
        <h2>Consommation Alcool</h2>
        <select id="alcohol-select"></select>
        <div class="form-group">
            <label>Quantit√© (cl)</label>
            <input type="number" id="alcohol-qty" value="10">
        </div>
        <button class="btn-submit" onclick="addAlcohol()">Boire</button>
    </section>

    <!-- 9. MES ALIMENTS -->
    <section id="foods-view" class="view">
        <button class="btn-back" onclick="showView('home-view')">‚Üê Retour</button>
        <h2>Biblioth√®que d'Aliments</h2>
        <div style="margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 20px;">
            <h3>Ajouter un nouveau</h3>
            <div class="form-group">
                <input type="text" id="new-food-name" placeholder="Nom (ex: Mon Granola)">
            </div>
            <div class="form-group" style="display:flex; gap:5px;">
                <input type="number" id="new-food-p" placeholder="Prot" style="width:33%">
                <input type="number" id="new-food-c" placeholder="Gluc" style="width:33%">
                <input type="number" id="new-food-f" placeholder="Lip" style="width:33%">
            </div>
            <button class="btn-small" onclick="createCustomFood()">+ Enregistrer</button>
        </div>
        <h3>Liste des Aliments</h3>
        <input type="text" id="food-list-search" placeholder="Filtrer la liste..." oninput="renderAllFoods()">
        <div id="all-foods-container" class="results-list" style="max-height: 400px;"></div>
    </section>

    <!-- 10. JOURNAL JOURNALIER (Historique du jour) -->
    <section id="journal-view" class="view">
        <button class="btn-back" onclick="showView('home-view')">‚Üê Retour</button>
        <h2>Journal d'aujourd'hui</h2>
        <p style="text-align:center; color:#888; margin-bottom:20px;">Cliquez sur üóëÔ∏è pour supprimer une entr√©e.</p>
        
        <div id="daily-log-container" class="results-list"></div>
        
        <div class="macro-summary" style="margin-top:20px;">
            <p>Total Actuel</p>
            <small id="journal-total-display">0 kcal</small>
        </div>
    </section>

    
    <script src="HuskyNutrition.js"></script>
</body>
</html>

